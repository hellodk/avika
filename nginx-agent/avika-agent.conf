# =============================================================================
# Avika NGINX Manager Agent Configuration
# =============================================================================
# Copy this file to /etc/avika/avika-agent.conf
# See deploy/config/avika-agent.conf.sample for full documentation

# -----------------------------------------------------------------------------
# GATEWAY CONNECTION
# -----------------------------------------------------------------------------

# Single Gateway (default)
GATEWAY_SERVER=""

# Multiple Gateways (high-availability mode)
# Comma-separated list - agent connects to ALL gateways simultaneously
# Example: GATEWAY_SERVERS="gw1.example.com:5020,gw2.example.com:5020"
GATEWAY_SERVERS="avika-gateway.labs.svc.cluster.local:5020,avika-gateway.avika.svc.cluster.local:50051,192.168.1.10:5020"

# -----------------------------------------------------------------------------
# AGENT IDENTITY
# -----------------------------------------------------------------------------

# Agent ID (leave empty for auto-detection: hostname+IP)
AGENT_ID=""

# -----------------------------------------------------------------------------
# NETWORK PORTS
# -----------------------------------------------------------------------------

# Health check endpoint port (/healthz, /readyz)
HEALTH_PORT=5026

# Management gRPC service port
MGMT_PORT=5025

# -----------------------------------------------------------------------------
# NGINX CONFIGURATION
# -----------------------------------------------------------------------------

# NGINX main config file path
NGINX_CONFIG_PATH="/etc/nginx/nginx.conf"

# NGINX stub_status endpoint URL
NGINX_STATUS_URL="http://127.0.0.1/nginx_status"

# -----------------------------------------------------------------------------
# LOG COLLECTION
# -----------------------------------------------------------------------------

# NGINX log paths
ACCESS_LOG_PATH="/var/log/nginx/access.log"
ERROR_LOG_PATH="/var/log/nginx/error.log"

# Log format: "combined" or "json"
LOG_FORMAT="combined"

# -----------------------------------------------------------------------------
# DATA PERSISTENCE
# -----------------------------------------------------------------------------

# WAL buffer directory (for message persistence)
BUFFER_DIR="/var/lib/avika/"

# NGINX config backup directory
BACKUP_DIR="/var/lib/avika/backups"

# -----------------------------------------------------------------------------
# SELF-UPDATE
# -----------------------------------------------------------------------------

# Update server URL (leave empty to disable)
UPDATE_SERVER="http://192.168.1.10:8090"

# Update check interval (Go duration format)
UPDATE_INTERVAL="168h"

# -----------------------------------------------------------------------------
# LOGGING
# -----------------------------------------------------------------------------

# Log level: debug, info, warn, error
LOG_LEVEL="info"

# Log file path (empty for stdout)
LOG_FILE="/var/log/avika/agent.log"
